var myScroll;var DialogScreen=(function(){var c;var o;var h;var m;var g;var i;var e=false;var j=false;var b;var l=function(){c=$(".data");o=$("#dialog-wrapper .scroller");h=$(".next.button");m=$(".sprite.name span");g=$(".sprite.face");myScroll=new iScroll("dialog-wrapper");$(window).bind("reorient",function(){setTimeout(function(){window.scrollTo(0,1);myScroll.refresh()},100)});$.reorient.start();$(".dialog.button").live("click",function(p){a($(p.target).attr("value"))});a("main-1")};var a=function(u){console.log("changeSlide("+u+")");var s=$(".slide."+u);console.log("$slide: "+s);if(!s.length){console.log("!!! No slide found by id "+u+". Aborting.");return}o.children().remove();e=false;var r=$(".face",s);if(r){k(r.attr("value"))}var q=$(".name",s);if(q){d(q.attr("value"))}var t=$(".next-button-target",s);
if(t.length){i=t.attr("value")}else{i=null}if(SlideUpdaters[u]){SlideUpdaters[u](s)}var p=$(".append",s);p.each(function(v,w){console.log("... i, elem: "+v+", "+w);if($(w).hasClass("text")){e=true;n();f($("<div />").appendTo(o),$(w).text())}else{o.append($(w).children())}})};var f=function(q,s){var r=q.append($('<div class="text-build" />'));var p;b=setInterval(function(){if(j||s==""){r.append(s);clearInterval(b);e=false;j=false;n()}else{p=s.substring(0,1);s=s.substring(1);r.append(p)}},50)};var d=function(p){m.text(p)};var k=function(p){console.log("[NOT IMPLEMENTED] updateFace("+p+")")};var n=function(){h.unbind("click");if(e){h.removeClass("disabled").bind("click",function(p){j=true})}else{if(i){h.removeClass("disabled").bind("click",function(p){a(i)})}else{h.addClass("disabled")}}};return{init:l}
})();$(document).ready(DialogScreen.init);