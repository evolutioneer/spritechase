var Landing=(function(){var k;var g;var n;var i;var f;var m=function(){debug("Landing.init()");k=$("#register-name-message");g=$("#register-password-message");n=$("#register-email-message");i=$("#register-submit");f=$("#login-submit");$("#register-name").bind("blur",a);$("#register-password-1,#register-password-2").bind("blur",j);$("#register-email").bind("blur",c);i.bind("click",h);f.bind("click",e);$("#login-name").bind("blur",d);$("#login-password").bind("blur",d)};var d=function(o){debug("onLoginBlur()");debug('name: "'+$("#login-name").attr("value")+'", pass: "'+$("#login-password").attr("value")+'"');if($("#login-name").attr("value")&&$("#login-password").attr("value")){debug("++++ Eh, good enough");f.removeClass("disabled")}else{f.addClass("disabled")}};var a=function(o){k.removeClass("valid").text("Checking...");
$.ajax({url:"/users/isFree/"+$("#register-name").attr("value"),datatype:"json",success:function(p){p=JSON.parse(p);if(p.response=="1"){debug("+++ Name is available!");k.addClass("valid").removeClass("neutral").text('"'+$("#register-name").attr("value")+'" is available');l()}else{if(p.response=="0"){$("#register-user-message").removeClass("valid").removeClass("neutral").text('"'+$("#register-name").attr("value")+'" is already taken')}else{$("#register-user-message").removeClass("valid").removeClass("neutral").text(p.response)}}},error:function(q,p){debug("!!! error: ".type)}})};var j=function(p){g.text("Checking...");var q=$("#register-password-1").attr("value");var o=$("#register-password-2").attr("value");if(q==""||o==""){g.removeClass("valid").addClass("neutral").text("Enter your password (twice)")
}else{if(q!=o){g.removeClass("valid").removeClass("neutral").text("The password fields do not match")}else{g.addClass("valid").removeClass("neutral").text("They match!");l()}}};var c=function(o){debug("onRegisterEmailBlur()");var p=$("#register-email").attr("value");if(b(p)){n.addClass("valid").removeClass("neutral").text("Thanks!  We will keep it private")}else{if(p==""){n.removeClass("valid").addClass("neutral").text("(optional) Enter your email")}else{n.removeClass("valid").removeClass("neutral").text("You did not enter a valid email address")}}};var l=function(){debug("registrationReadyCheck()");if(k.hasClass("valid")&&g.hasClass("valid")){i.removeClass("disabled")}else{i.addClass("disabled")}};var h=function(o){debug("onRegisterSubmit()");if(i.hasClass("disabled")){return}$("#register-form").submit()
};var e=function(o){debug("onLoginSubmit()");if(f.hasClass("disabled")){return}$("#login-form").submit()};var b=function(o){var p=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return o.match(p)};return{init:m}})();$(document).ready(Landing.init);