var Landing=(function(){var l;var h;var o;var j;var g;var n=function(){debug("Landing.init()");l=$("#register-name-message");h=$("#register-password-message");o=$("#register-email-message");j=$("#register-submit");g=$("#login-submit");$("#login-name,#register-name").bind("focus",b);$("#register-name").bind("blur",a);$("#register-password-1,#register-password-2").bind("blur",k);$("#register-email").bind("blur",d);j.bind("click",i);g.bind("click",f);$("#login-name").bind("blur",e);$("#login-password").bind("blur",e)};var b=function(p){console.log("removeInstructionText");if($(p.currentTarget).attr("value")=="enter your username"){$(p.currentTarget).attr("value","")}};var e=function(p){debug("onLoginBlur()");debug('name: "'+$("#login-name").attr("value")+'", pass: "'+$("#login-password").attr("value")+'"');
if($("#login-name").attr("value")&&$("#login-password").attr("value")){debug("++++ Eh, good enough");g.removeClass("disabled")}else{g.addClass("disabled")}};var a=function(p){l.removeClass("valid").text("Checking...");$.ajax({url:"/users/isFree/"+$("#register-name").attr("value"),datatype:"json",success:function(q){q=JSON.parse(q);if(q.response=="1"){debug("+++ Name is available!");l.addClass("valid").removeClass("neutral").text('"'+$("#register-name").attr("value")+'" is available');m()}else{if(q.response=="0"){$("#register-user-message").removeClass("valid").removeClass("neutral").text('"'+$("#register-name").attr("value")+'" is already taken')}else{$("#register-user-message").removeClass("valid").removeClass("neutral").text(q.response)}}},error:function(r,q){debug("!!! error: ".type)}})};
var k=function(q){h.text("Checking...");var r=$("#register-password-1").attr("value");var p=$("#register-password-2").attr("value");if(r==""||p==""){h.removeClass("valid").addClass("neutral").text("Enter your password (twice)")}else{if(r!=p){h.removeClass("valid").removeClass("neutral").text("The password fields do not match")}else{h.addClass("valid").removeClass("neutral").text("They match!");m()}}};var d=function(p){debug("onRegisterEmailBlur()");var q=$("#register-email").attr("value");if(c(q)){o.addClass("valid").removeClass("neutral").text("Thanks!  We will keep it private")}else{if(q==""){o.removeClass("valid").addClass("neutral").text("(optional) Enter your email")}else{o.removeClass("valid").removeClass("neutral").text("You did not enter a valid email address")}}};var m=function(){debug("registrationReadyCheck()");
if(l.hasClass("valid")&&h.hasClass("valid")){j.removeClass("disabled")}else{j.addClass("disabled")}};var i=function(p){debug("onRegisterSubmit()");if(j.hasClass("disabled")){return}$("#register-form").submit()};var f=function(p){debug("onLoginSubmit()");if(g.hasClass("disabled")){return}$("#login-form").submit()};var c=function(p){var q=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return p.match(q)};return{init:n}})();$(document).ready(Landing.init);